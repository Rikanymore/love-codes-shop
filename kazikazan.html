<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sonsuz AÅŸk | Sana Ã–zel Bir SÃ¼rpriz</title>
    <style>
        /* --- GENEL ATMOSFER --- */
        body {
            margin: 0; padding: 0; background-color: #110307; color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex; justify-content: center; align-items: center; height: 100vh;
            overflow: hidden; touch-action: none;
            background: radial-gradient(circle at center, #2e0813 0%, #0a0103 100%);
        }

        .back-btn {
            position: absolute; top: 20px; left: 20px;
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2); color: #fff;
            padding: 8px 15px; border-radius: 10px; cursor: pointer; text-decoration: none;
            font-size: 0.9rem; z-index: 1000; transition: all 0.3s ease;
        }
        .back-btn:hover { border-color: #f43f5e; color: #f43f5e; }

        /* --- ATEÅBÃ–CEKLERÄ° EFEKTÄ° --- */
        .firefly {
            position: absolute; width: 4px; height: 4px; background: #fca5a5;
            border-radius: 50%; box-shadow: 0 0 10px 2px #f43f5e;
            animation: float 10s infinite ease-in-out alternate; z-index: 0;
        }
        @keyframes float {
            0% { transform: translateY(0) translateX(0) scale(1); opacity: 0.2; }
            100% { transform: translateY(-100px) translateX(50px) scale(1.5); opacity: 0.8; }
        }

        /* --- 1. AÅAMA: MÃœHÃœRLÃœ GÄ°RÄ°Å --- */
        #intro-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 50; background: rgba(10, 1, 3, 0.9); backdrop-filter: blur(10px);
            transition: opacity 1s ease;
        }
        .wax-seal {
            width: 120px; height: 120px; background: radial-gradient(circle, #be123c, #881337);
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-size: 3rem; cursor: pointer; box-shadow: 0 10px 30px rgba(190, 18, 60, 0.5), inset 0 0 15px rgba(0,0,0,0.5);
            border: 4px solid #f43f5e; animation: heartbeat 1.5s infinite;
        }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); box-shadow: 0 10px 50px rgba(244, 63, 94, 0.8); } }
        .intro-text { margin-top: 30px; font-size: 1.2rem; color: #fda4af; letter-spacing: 2px; text-transform: uppercase; }

        /* --- 2. AÅAMA: KAZI KAZAN KARTI --- */
        #card-wrapper {
            opacity: 0; transform: scale(0.8); pointer-events: none;
            transition: all 1s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 10;
        }
        #card-wrapper.active { opacity: 1; transform: scale(1); pointer-events: auto; }

        .card-container {
            position: relative; width: 340px; height: 480px;
            border-radius: 15px; box-shadow: 0 20px 50px rgba(244, 63, 94, 0.3);
            border: 3px solid #fca5a5; overflow: hidden; background: #fff;
        }

        .secret-content {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; justify-content: flex-end;
            align-items: center; text-align: center; z-index: 1;
        }

        .text-overlay {
            width: 100%; background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.5) 60%, transparent 100%);
            padding: 40px 20px 30px 20px; box-sizing: border-box;
            transform: translateY(100%); transition: transform 1s ease;
        }
        .secret-content.revealed .text-overlay { transform: translateY(0); }

        .secret-content h2 { color: #fca5a5; font-size: 2rem; margin: 0 0 10px 0; text-shadow: 0 2px 5px #000; }
        .secret-content p { color: #f1f5f9; font-size: 1.1rem; line-height: 1.5; margin: 0 0 20px 0; }

        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; cursor: pointer; transition: opacity 0.8s ease; }

        /* --- AÅAMA 3'E GEÃ‡Ä°Å BUTONU --- */
        .read-letter-btn {
            background: linear-gradient(45deg, #f43f5e, #be123c); color: white;
            border: none; padding: 12px 30px; font-size: 1.1rem; font-weight: bold;
            border-radius: 30px; cursor: pointer; box-shadow: 0 0 20px rgba(244, 63, 94, 0.6);
            opacity: 0; transform: translateY(20px); transition: all 0.5s ease; pointer-events: none;
        }
        .read-letter-btn.show { opacity: 1; transform: translateY(0); pointer-events: auto; animation: pulse-btn 2s infinite; }
        @keyframes pulse-btn { 0%, 100% { box-shadow: 0 0 20px rgba(244, 63, 94, 0.6); } 50% { box-shadow: 0 0 40px rgba(244, 63, 94, 1); } }

        /* --- 3. AÅAMA: ROMANTÄ°K MEKTUP EKRANI --- */
        #letter-modal {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 1, 3, 0.95); backdrop-filter: blur(15px);
            display: flex; justify-content: center; align-items: center;
            z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.8s ease;
        }
        #letter-modal.open { opacity: 1; pointer-events: auto; }

        .letter-paper {
            width: 90%; max-width: 450px; max-height: 80vh; overflow-y: auto;
            background: #fdfbf7; color: #3a0a18; padding: 40px; border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5); font-family: 'Georgia', serif;
            line-height: 1.8; position: relative;
        }
        
        /* KaÄŸÄ±t dokusu hissiyatÄ± */
        .letter-paper::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/cream-paper.png');
            opacity: 0.5; pointer-events: none;
        }

        .letter-header { font-size: 2rem; color: #be123c; margin-bottom: 20px; font-style: italic; text-align: center; }
        .letter-body { font-size: 1.1rem; text-align: justify; margin-bottom: 30px; white-space: pre-wrap; }
        .letter-footer { text-align: right; font-weight: bold; font-size: 1.2rem; color: #be123c; font-style: italic; }

        /* Kapat butonu */
        .close-letter {
            position: absolute; top: 15px; right: 20px; font-size: 2rem;
            color: #be123c; cursor: pointer; font-family: sans-serif;
        }

        /* YÃ¶nlendirme yazÄ±sÄ± */
        .instruction {
            position: absolute; bottom: -40px; width: 100%; text-align: center;
            color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; pointer-events: none;
        }

    </style>
</head>
<body>

    <audio id="bg-music" src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3" loop></audio>
    <audio id="scratch-sound" src="https://cdn.pixabay.com/download/audio/2023/02/28/audio_824cd1dbfc.mp3" loop></audio>
    <audio id="magic-sound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_0625c1539c.mp3"></audio>

    <a href="index.html" class="back-btn">â† Ã‡Ä±kÄ±ÅŸ</a>

    <div id="fireflies-container"></div>

    <div id="intro-screen">
        <div class="wax-seal" onclick="startJourney()">ğŸ’Œ</div>
        <div class="intro-text">Sana Ã–zel Bir Mesaj Var</div>
    </div>

    <div id="card-wrapper">
        <div class="card-container">
            <div class="secret-content" id="secret-content">
                <div class="text-overlay">
                    <h2 id="secret-title">BÃ¼yÃ¼k SÃ¼rpriz!</h2>
                    <p id="secret-message">KÃ¼Ã§Ã¼k mesaj buraya gelecek.</p>
                    <button class="read-letter-btn" id="read-btn" onclick="openLetter()">Mektubu Oku ğŸ’Œ</button>
                </div>
            </div>
            <canvas id="scratch-canvas"></canvas>
        </div>
        <div class="instruction" id="inst-text">KazÄ±mak iÃ§in ekrana sÃ¼rt ğŸª™</div>
    </div>

    <div id="letter-modal">
        <div class="letter-paper">
            <div class="close-letter" onclick="closeLetter()">Ã—</div>
            <div class="letter-header" id="letter-header">Sevgilim,</div>
            <div class="letter-body" id="letter-body">Uzun aÅŸk mektubu buraya...</div>
            <div class="letter-footer" id="letter-footer">- Seni Ã‡ok Seven...</div>
        </div>
    </div>

    <script>
        // ==========================================
        // ğŸ› ï¸ MÃœÅTERÄ° SÄ°PARÄ°Å AYARLARI
        // ==========================================
        
        // --- GÃ–RSELLER VE MÃœZÄ°K ---
        const ARKA_PLAN_FOTOGRAFI = "https://images.unsplash.com/photo-1518199266791-5375a83164ba?q=80&w=600&auto=format&fit=crop"; 
        
        // --- 1. AÅAMA: KAZI KAZAN MESAJI ---
        const UST_YAZI = "KazÄ± ve KeÅŸfet"; // AltÄ±n katman yazÄ±sÄ±
        const SURPRIZ_BASLIK = "Ä°yi ki VarsÄ±n!";
        const SURPRIZ_KISA_MESAJ = "Her anÄ±mda yanÄ±mda olduÄŸun iÃ§in teÅŸekkÃ¼r ederim.";
        
        // --- 2. AÅAMA: UZUN AÅK MEKTUBU ---
        const MEKTUP_HITAP = "HayatÄ±mÄ±n AnlamÄ±na,";
        const MEKTUP_ICERIK = "Belki sana her gÃ¼n seni ne kadar sevdiÄŸimi sÃ¶ylÃ¼yorum ama bunu bir de bÃ¶yle kalÄ±cÄ± bir anÄ± olarak bÄ±rakmak istedim.\n\nSeninle tanÄ±ÅŸtÄ±ÄŸÄ±m o ilk gÃ¼nden beri hayatÄ±mdaki tÃ¼m renkler deÄŸiÅŸti. Beraber gÃ¼ldÃ¼ÄŸÃ¼mÃ¼z, saatlerce sohbet ettiÄŸimiz her anÄ± kalbimin en derin kÃ¶ÅŸesinde saklÄ±yorum.\n\nZaman ne kadar hÄ±zlÄ± geÃ§erse geÃ§sin, ellerimizi hiÃ§ bÄ±rakmamamÄ±z dileÄŸiyle. Bu kÃ¼Ã§Ã¼k dijital evren sadece ikimize ait.\n\nÄ°yi ki hayatÄ±mdasÄ±n, iyi ki benimsin.";
        const MEKTUP_IMZA = "- Sonsuz AÅŸkÄ±n";

        // ==========================================

        // DOM Elementlerini Ayarla
        document.getElementById('secret-title').innerText = SURPRIZ_BASLIK;
        document.getElementById('secret-message').innerText = SURPRIZ_KISA_MESAJ;
        document.getElementById('secret-content').style.backgroundImage = `url('${ARKA_PLAN_FOTOGRAFI}')`;
        
        document.getElementById('letter-header').innerText = MEKTUP_HITAP;
        document.getElementById('letter-body').innerText = MEKTUP_ICERIK;
        document.getElementById('letter-footer').innerText = MEKTUP_IMZA;

        // AteÅŸbÃ¶cekleri OluÅŸtur
        const firefliesContainer = document.getElementById('fireflies-container');
        for(let i=0; i<30; i++) {
            let firefly = document.createElement('div');
            firefly.className = 'firefly';
            firefly.style.left = Math.random() * 100 + 'vw';
            firefly.style.top = Math.random() * 100 + 'vh';
            firefly.style.animationDuration = (Math.random() * 5 + 5) + 's';
            firefly.style.animationDelay = (Math.random() * 5) + 's';
            firefliesContainer.appendChild(firefly);
        }

        // AÅAMA 1 -> AÅAMA 2 GEÃ‡Ä°ÅÄ°
        const introScreen = document.getElementById('intro-screen');
        const cardWrapper = document.getElementById('card-wrapper');
        const bgMusic = document.getElementById('bg-music');
        bgMusic.volume = 0.4;

        function startJourney() {
            // MÃ¼zik BaÅŸlasÄ±n
            bgMusic.play().catch(e => console.log("MÃ¼zik izni yok"));
            
            // MÃ¼hrÃ¼ gizle, KartÄ± getir
            introScreen.style.opacity = '0';
            setTimeout(() => {
                introScreen.style.display = 'none';
                cardWrapper.classList.add('active');
                resizeCanvas(); // Kart ortaya Ã§Ä±kÄ±nca canvasÄ± ayarla
            }, 1000);
        }

        // KAZI KAZAN MEKANÄ°KLERÄ°
        const canvas = document.getElementById('scratch-canvas');
        const ctx = canvas.getContext('2d');
        const cardContainer = document.querySelector('.card-container');
        const secretContentBox = document.getElementById('secret-content');
        const readBtn = document.getElementById('read-btn');
        const scratchSound = document.getElementById('scratch-sound');
        const magicSound = document.getElementById('magic-sound');
        scratchSound.volume = 0.5;

        let isDrawing = false;
        let isRevealed = false; 

        function resizeCanvas() {
            canvas.width = cardContainer.offsetWidth;
            canvas.height = cardContainer.offsetHeight;
            fillCanvas(); 
        }

        function fillCanvas() {
            // AltÄ±n/Rose Gold Gradyan
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#fda4af'); 
            gradient.addColorStop(0.5, '#f43f5e'); 
            gradient.addColorStop(1, '#9f1239'); 
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.font = "bold 32px 'Segoe UI'";
            ctx.fillStyle = "#fff"; 
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(UST_YAZI, canvas.width / 2, canvas.height / 2);
        }

        function getBrushPos(e) {
            const rect = canvas.getBoundingClientRect();
            let clientX = e.clientX || (e.touches && e.touches[0].clientX);
            let clientY = e.clientY || (e.touches && e.touches[0].clientY);
            return { x: clientX - rect.left, y: clientY - rect.top };
        }

        function startDrawing(e) {
            if (isRevealed) return;
            isDrawing = true;
            scratchSound.play();
            const pos = getBrushPos(e);
            ctx.moveTo(pos.x, pos.y);
            scratch(e); 
        }

        function scratch(e) {
            if (!isDrawing || isRevealed) return;
            e.preventDefault(); 
            const pos = getBrushPos(e);

            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc(pos.x, pos.y, 40, 0, Math.PI * 2); 
            ctx.fill();

            checkRevealPercent();
        }

        function stopDrawing() {
            isDrawing = false;
            scratchSound.pause(); 
        }

        function checkRevealPercent() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const pixels = imageData.data;
            let transparentPixels = 0;

            for (let i = 3; i < pixels.length; i += 16) {
                if (pixels[i] === 0) transparentPixels++;
            }

            const totalPixels = (canvas.width * canvas.height) / 4; 
            const percent = (transparentPixels / totalPixels) * 100;

            if (percent > 45 && !isRevealed) {
                isRevealed = true;
                scratchSound.pause(); 
                magicSound.play();  
                
                canvas.style.opacity = "0"; 
                document.getElementById('inst-text').style.opacity = "0";
                secretContentBox.classList.add('revealed');
                
                setTimeout(() => {
                    canvas.style.display = "none";
                    readBtn.classList.add('show'); // MEKTUP BUTONUNU GÃ–STER
                }, 1000);
            }
        }

        // AÅAMA 3: MEKTUP KONTROLLERÄ°
        const letterModal = document.getElementById('letter-modal');

        function openLetter() {
            letterModal.classList.add('open');
        }

        function closeLetter() {
            letterModal.classList.remove('open');
        }

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', scratch);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseleave', stopDrawing);
        canvas.addEventListener('touchstart', startDrawing, {passive: false});
        canvas.addEventListener('touchmove', scratch, {passive: false});
        canvas.addEventListener('touchend', stopDrawing);
        window.addEventListener('resize', () => { if(!isRevealed) resizeCanvas(); }); 
    </script>
</body>
</html>